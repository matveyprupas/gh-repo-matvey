"use strict";(self.webpackChunkh3_consumer_web=self.webpackChunkh3_consumer_web||[]).push([[974],{"./src/views/ManageMedication/views/AddMedications/components/MedicationSearch/MedicationSearchDropdown/MedicationSearchDropdown.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default},default:function(){return MedicationSearchDropdown_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),react_router=__webpack_require__("./node_modules/react-router/index.js"),Icon=__webpack_require__("./src/components/Icon/index.ts"),useTranslation=__webpack_require__("./node_modules/react-i18next/dist/es/useTranslation.js"),routes=__webpack_require__("./src/constants/routes.ts"),MedicationSearchDropdown_module_root="MedicationSearchDropdown_root__GWCcN",MedicationSearchDropdown_module_list="MedicationSearchDropdown_list__1h3qO",MedicationSearchDropdown_module_narrow="MedicationSearchDropdown_narrow__maeEE",MedicationSearchDropdown_module_see_all="MedicationSearchDropdown_see-all__D1tzf",MedicationSearchResult_module_root="MedicationSearchResult_root__-3JOE",MedicationSearchResult_module_icon="MedicationSearchResult_icon__BwTpx",MedicationSearchResult_module_text="MedicationSearchResult_text__VYNcR",jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),MedicationSearchResult=function MedicationSearchResult(_ref){var children=_ref.children;return(0,jsx_runtime.jsxs)("span",{className:MedicationSearchResult_module_root,"data-testid":"medication-search-result",children:[(0,jsx_runtime.jsx)("span",{className:MedicationSearchResult_module_icon,children:(0,jsx_runtime.jsx)(Icon.JO,{type:"search-updated"})}),(0,jsx_runtime.jsx)("span",{className:MedicationSearchResult_module_text,children:children})]})};try{MedicationSearchResult.displayName="MedicationSearchResult",MedicationSearchResult.__docgenInfo={description:"",displayName:"MedicationSearchResult",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/views/ManageMedication/views/AddMedications/components/MedicationSearch/MedicationSearchResult/MedicationSearchResult.tsx#MedicationSearchResult"]={docgenInfo:MedicationSearchResult.__docgenInfo,name:"MedicationSearchResult",path:"src/views/ManageMedication/views/AddMedications/components/MedicationSearch/MedicationSearchResult/MedicationSearchResult.tsx#MedicationSearchResult"})}catch(__react_docgen_typescript_loader_error){}var MedicationSearchDropdown=(0,react.forwardRef)((function(_ref,ref){var searchTerm=_ref.searchTerm,isShowingResults=_ref.isShowingResults,medications=_ref.medications,id=_ref.id,showResults=_ref.showResults,setActiveDescendant=_ref.setActiveDescendant,location=(0,react_router.TH)(),t=(0,useTranslation.$)().t,navigate=(0,react_router.s0)(),resultDiv=(0,react.useRef)(null);(0,react.useEffect)((function(){var onArrows=function onArrows(direction,activeElement,results){if("option"===(null==activeElement?void 0:activeElement.getAttribute("role"))){null==activeElement||activeElement.setAttribute("aria-selected","false");var nextSibling=(null==activeElement?void 0:activeElement.nextElementSibling)||results[0];"up"===direction&&(nextSibling=(null==activeElement?void 0:activeElement.previousElementSibling)||results[results.length-1]);var activeDescendantId=function setFocus(element){var activeDescendantId=(null==element?void 0:element.getAttribute("id"))||"";return null==element||element.focus(),null==element||element.setAttribute("aria-selected","true"),activeDescendantId}(nextSibling);setActiveDescendant(activeDescendantId)}},handleKeyDown=function handleKeyDown(event){var _resultDiv$current,activeElement=document.activeElement;if("option"===(null==activeElement?void 0:activeElement.getAttribute("role"))){var results=null==resultDiv||null===(_resultDiv$current=resultDiv.current)||void 0===_resultDiv$current?void 0:_resultDiv$current.querySelectorAll('[data-element="result"]');if(results)switch(event.key){case"ArrowDown":onArrows("down",activeElement,results),event.preventDefault();break;case"ArrowUp":onArrows("up",activeElement,results),event.preventDefault()}}};return window.addEventListener("keydown",handleKeyDown),function(){window.removeEventListener("keydown",handleKeyDown)}}),[ref,setActiveDescendant]);var boldResults=function boldResults(text){var newText=text.replace(" "," "),newSearch=searchTerm.replace(" "," "),textArray=newText.split(newSearch);return textArray.map((function(item,index){return(0,jsx_runtime.jsxs)(react.Fragment,{children:[item.replace(/ /g," "),index!==textArray.length-1&&(0,jsx_runtime.jsx)("strong",{children:searchTerm.replace(/ /g," ")})]},item)}))},redirectToAddMedicine=function redirectToAddMedicine(med){var _location$state;navigate("".concat(routes._.medicationManagement.add,"/").concat(med.productId),{state:{name:med.name,description:med.description,medicationGroup:med.medicationGroup,productId:med.productId,gpi:med.gpi,hasFinishCard:null==location||null===(_location$state=location.state)||void 0===_location$state?void 0:_location$state.hasFinishCard,searchTerm:searchTerm,isShowingResults:isShowingResults,searchLocation:"dropdown"}})};return searchTerm.length<3?(0,jsx_runtime.jsx)("div",{className:MedicationSearchDropdown_module_root,"data-testid":"under-length",children:(0,jsx_runtime.jsxs)("div",{"data-element":"under-length",children:[(0,jsx_runtime.jsx)(Icon.JO,{type:"info"}),(0,jsx_runtime.jsx)("p",{id:"search-extra-description","aria-live":"polite",children:t("views.medicationSearch.length")})]})}):(0,jsx_runtime.jsx)("div",{className:MedicationSearchDropdown_module_root,ref:resultDiv,children:medications&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("p",{className:MedicationSearchDropdown_module_narrow,"data-testid":"narrow",id:"search-extra-description","aria-live":"polite",children:[t("views.medicationSearch.narrowStart")," ",medications.length," ",t("views.medicationSearch.narrowEnd")]}),(0,jsx_runtime.jsx)("ul",{className:MedicationSearchDropdown_module_list,id:id,role:"listbox",ref:ref,"data-testid":"listbox",children:null==medications?void 0:medications.map((function(med,index){return(0,jsx_runtime.jsx)("li",{"data-element":"result",id:"id-".concat(med.productId),role:"option","aria-selected":!1,tabIndex:-1,"data-testid":"test-".concat(index),onClick:function onClick(){redirectToAddMedicine(med)},onKeyDown:function onKeyDown(event){"Enter"===event.key&&redirectToAddMedicine(med)},children:(0,jsx_runtime.jsx)(MedicationSearchResult,{children:boldResults("".concat(med.name," ").concat(med.description))})},med.productId)}))}),showResults&&(0,jsx_runtime.jsx)("div",{className:MedicationSearchDropdown_module_see_all,"data-element":"see-all","data-testid":"see-all",children:(0,jsx_runtime.jsx)("button",{type:"button",onClick:showResults,"data-element":"show-all",children:t("views.medicationSearch.seeAll")})})]})})}));MedicationSearchDropdown.displayName="MedicationSearchDropdown";try{MedicationSearchDropdown.displayName="MedicationSearchDropdown",MedicationSearchDropdown.__docgenInfo={description:"",displayName:"MedicationSearchDropdown",props:{searchTerm:{defaultValue:null,description:"",name:"searchTerm",required:!0,type:{name:"string"}},isShowingResults:{defaultValue:null,description:"",name:"isShowingResults",required:!1,type:{name:"boolean"}},medications:{defaultValue:null,description:"",name:"medications",required:!1,type:{name:"Medications[]"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},setActiveDescendant:{defaultValue:null,description:"",name:"setActiveDescendant",required:!0,type:{name:"Dispatch<SetStateAction<string>>"}},showResults:{defaultValue:null,description:"",name:"showResults",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/views/ManageMedication/views/AddMedications/components/MedicationSearch/MedicationSearchDropdown/MedicationSearchDropdown.tsx#MedicationSearchDropdown"]={docgenInfo:MedicationSearchDropdown.__docgenInfo,name:"MedicationSearchDropdown",path:"src/views/ManageMedication/views/AddMedications/components/MedicationSearch/MedicationSearchDropdown/MedicationSearchDropdown.tsx#MedicationSearchDropdown"})}catch(__react_docgen_typescript_loader_error){}var MedicationSearchDropdown_stories={title:"Consumer Web / Medication Search / Dropdown",component:MedicationSearchDropdown},Default=function Template(args){return(0,jsx_runtime.jsx)("div",{style:{maxWidth:"900px",position:"relative"},children:(0,jsx_runtime.jsx)(MedicationSearchDropdown,(0,objectSpread2.Z)({},args))})}.bind({});Default.args={medications:[{productId:"00071-0155",gpi:"39400010100310",name:"Lipitor",description:"Tablet 10 MG (Base Equivalent)",medicationGroup:"Tablet"},{productId:"00071-0156",gpi:"39400010100320",name:"Lipitor",description:"Tablet 20 MG (Base Equivalent)",medicationGroup:"Tablet"},{productId:"00071-0157",gpi:"39400010100330",name:"Lipitor",description:"Tablet 40 MG (Base Equivalent)",medicationGroup:"Tablet"},{productId:"00071-0158",gpi:"39400010100350",name:"Lipitor",description:"Tablet 80 MG (Base Equivalent)",medicationGroup:"Tablet"}],searchTerm:"Lipitor",id:"test",setActiveDescendant:function setActiveDescendant(){},showResults:function showResults(){}},Default.parameters=(0,objectSpread2.Z)({storySource:{source:"(args) => (\n  <div style={{ maxWidth: '900px', position: 'relative' }}>\n    <MedicationSearchDropdown {...args} />\n  </div>\n)"}},Default.parameters)}}]);